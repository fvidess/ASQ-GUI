{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\fvide\\\\Desktop\\\\MISC\\\\asq-gui-ts\\\\src\\\\components\\\\login.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { useLocation } from \"react-router-dom\";\nimport { useApi } from \"../api\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n/*==========================================================\r\n * RequireLogin component:\r\n *   Only shows children if we have a log-in for the API\r\n */\n\nexport default function RequireLogin(_ref) {\n  _s();\n  let {\n    children\n  } = _ref;\n  const api = useApi();\n  if (api.loggedIn) {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: children\n    }, void 0, false);\n  } else {\n    return /*#__PURE__*/_jsxDEV(Login, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 21,\n      columnNumber: 12\n    }, this);\n  }\n}\n\n/*==========================================================\r\n * Login component:\r\n *   Shows log-in page with link to Google\r\n */\n\n// helper function\n_s(RequireLogin, \"JrT4+2NswhoWmeifml0TF7ey2qk=\", false, function () {\n  return [useApi];\n});\n_c = RequireLogin;\nfunction addParams(params, values) {\n  for (const key in values) {\n    params.set(key, values[key]);\n  }\n}\nexport function Login() {\n  _s2();\n  let location = useLocation();\n  let params = new URLSearchParams(location.search.substring(1));\n  let error = params.get('error');\n  const href = new URL('https://accounts.google.com/o/oauth2/v2/auth');\n  addParams(href.searchParams, {\n    client_id: '923167133428-nfsjgjq82p4gqqoca5htfqgslmbi6uv9.apps.googleusercontent.com',\n    redirect_uri: 'http://localhost:3000/asq/auth',\n    response_type: 'id_token',\n    scope: 'openid email profile',\n    state: location.pathname,\n    nonce: crypto.randomUUID()\n  });\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Log-in Required\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 18\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [/*#__PURE__*/_jsxDEV(\"a\", {\n        href: href.toString(),\n        children: \"Click here\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 9\n      }, this), \" to log in with Google.\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_s2(Login, \"pkHmaVRPskBaU4tMJuJJpV42k1I=\", false, function () {\n  return [useLocation];\n});\n_c2 = Login;\nvar _c, _c2;\n$RefreshReg$(_c, \"RequireLogin\");\n$RefreshReg$(_c2, \"Login\");","map":{"version":3,"names":["useLocation","useApi","Fragment","_Fragment","jsxDEV","_jsxDEV","RequireLogin","_ref","_s","children","api","loggedIn","Login","fileName","_jsxFileName","lineNumber","columnNumber","_c","addParams","params","values","key","set","_s2","location","URLSearchParams","search","substring","error","get","href","URL","searchParams","client_id","redirect_uri","response_type","scope","state","pathname","nonce","crypto","randomUUID","toString","_c2","$RefreshReg$"],"sources":["C:/Users/fvide/Desktop/MISC/asq-gui-ts/src/components/login.tsx"],"sourcesContent":["import { ReactElement, ReactNode } from \"react\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport { useApi } from \"../api\";\r\n\r\nexport interface RequireLoginProps {\r\n  children: ReactNode;\r\n}\r\n\r\n/*==========================================================\r\n * RequireLogin component:\r\n *   Only shows children if we have a log-in for the API\r\n */\r\n\r\nexport default function RequireLogin({ children }: RequireLoginProps): ReactElement {\r\n  const api = useApi();\r\n\r\n  if (api.loggedIn) {\r\n    return <>{children}</>\r\n  }\r\n  else {\r\n    return <Login />\r\n  }\r\n}\r\n\r\n/*==========================================================\r\n * Login component:\r\n *   Shows log-in page with link to Google\r\n */\r\n\r\n// helper function\r\nfunction addParams(params: URLSearchParams, values: { [key: string]: string }) {\r\n  for (const key in values) {\r\n    params.set(key, values[key]);\r\n  }\r\n}\r\n\r\nexport function Login() {\r\n  let location = useLocation();\r\n  let params = new URLSearchParams(location.search.substring(1));\r\n  let error = params.get('error');\r\n\r\n  const href = new URL('https://accounts.google.com/o/oauth2/v2/auth');\r\n  addParams(href.searchParams, {\r\n    client_id: '923167133428-nfsjgjq82p4gqqoca5htfqgslmbi6uv9.apps.googleusercontent.com',\r\n    redirect_uri: 'http://localhost:3000/asq/auth',\r\n    response_type: 'id_token',\r\n    scope: 'openid email profile',\r\n    state: location.pathname,\r\n    nonce: crypto.randomUUID(),\r\n  });\r\n\r\n  return (\r\n    <>\r\n      <h1>Log-in Required</h1>\r\n      { error && <p>{error}</p> }\r\n      <p>\r\n        <a href={href.toString()}>Click here</a> to log in with Google.\r\n      </p>\r\n    </>\r\n  )\r\n}\r\n"],"mappings":";;;AACA,SAASA,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,MAAM,QAAQ,QAAQ;AAAC,SAAAC,QAAA,IAAAC,SAAA;AAAA,SAAAC,MAAA,IAAAC,OAAA;AAMhC;AACA;AACA;AACA;;AAEA,eAAe,SAASC,YAAYA,CAAAC,IAAA,EAAgD;EAAAC,EAAA;EAAA,IAA/C;IAAEC;EAA4B,CAAC,GAAAF,IAAA;EAClE,MAAMG,GAAG,GAAGT,MAAM,EAAE;EAEpB,IAAIS,GAAG,CAACC,QAAQ,EAAE;IAChB,oBAAON,OAAA,CAAAF,SAAA;MAAAM,QAAA,EAAGA;IAAQ,iBAAI;EACxB,CAAC,MACI;IACH,oBAAOJ,OAAA,CAACO,KAAK;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,QAAG;EAClB;AACF;;AAEA;AACA;AACA;AACA;;AAEA;AAAAR,EAAA,CAhBwBF,YAAY;EAAA,QACtBL,MAAM;AAAA;AAAAgB,EAAA,GADIX,YAAY;AAiBpC,SAASY,SAASA,CAACC,MAAuB,EAAEC,MAAiC,EAAE;EAC7E,KAAK,MAAMC,GAAG,IAAID,MAAM,EAAE;IACxBD,MAAM,CAACG,GAAG,CAACD,GAAG,EAAED,MAAM,CAACC,GAAG,CAAC,CAAC;EAC9B;AACF;AAEA,OAAO,SAAST,KAAKA,CAAA,EAAG;EAAAW,GAAA;EACtB,IAAIC,QAAQ,GAAGxB,WAAW,EAAE;EAC5B,IAAImB,MAAM,GAAG,IAAIM,eAAe,CAACD,QAAQ,CAACE,MAAM,CAACC,SAAS,CAAC,CAAC,CAAC,CAAC;EAC9D,IAAIC,KAAK,GAAGT,MAAM,CAACU,GAAG,CAAC,OAAO,CAAC;EAE/B,MAAMC,IAAI,GAAG,IAAIC,GAAG,CAAC,8CAA8C,CAAC;EACpEb,SAAS,CAACY,IAAI,CAACE,YAAY,EAAE;IAC3BC,SAAS,EAAE,0EAA0E;IACrFC,YAAY,EAAE,gCAAgC;IAC9CC,aAAa,EAAE,UAAU;IACzBC,KAAK,EAAE,sBAAsB;IAC7BC,KAAK,EAAEb,QAAQ,CAACc,QAAQ;IACxBC,KAAK,EAAEC,MAAM,CAACC,UAAU;EAC1B,CAAC,CAAC;EAEF,oBACEpC,OAAA,CAAAF,SAAA;IAAAM,QAAA,gBACEJ,OAAA;MAAAI,QAAA,EAAI;IAAe;MAAAI,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,QAAK,EACtBY,KAAK,iBAAIvB,OAAA;MAAAI,QAAA,EAAImB;IAAK;MAAAf,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,QAAK,eACzBX,OAAA;MAAAI,QAAA,gBACEJ,OAAA;QAAGyB,IAAI,EAAEA,IAAI,CAACY,QAAQ,EAAG;QAAAjC,QAAA,EAAC;MAAU;QAAAI,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,QAAI,2BAC1C;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,QAAI;EAAA,gBACH;AAEP;AAACO,GAAA,CAxBeX,KAAK;EAAA,QACJZ,WAAW;AAAA;AAAA2C,GAAA,GADZ/B,KAAK;AAAA,IAAAK,EAAA,EAAA0B,GAAA;AAAAC,YAAA,CAAA3B,EAAA;AAAA2B,YAAA,CAAAD,GAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}